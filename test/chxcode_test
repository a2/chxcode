# shellcheck shell=sh

. ./test/helper

test_exec_with_no_arguments() {
  touch "$APPLICATIONS/Xcode.app"
  touch "$APPLICATIONS/Xcode-1.0.app"
  mkdir -p "$APPLICATIONS/Xcode-9.3.app/Contents/Developer"
  touch "$APPLICATIONS/Xcode-9.4.app"
  export DEVELOPER_DIR="$APPLICATIONS/Xcode-9.3.app/Contents/Developer"

  xcodes=$(chxcode | tr '\n' ' ' | xargs)

  assertEquals "should print installed xcodes" "1.0 * 9.3 9.4" "$xcodes"
}

test_change_unknown_xcode_reports_error() {
  assertEquals "Unknown Xcode: 1.0" "$(chxcode 1.0 2>&1)"
}

test_change_unknown_xcode_exit_code() {
  chxcode 1.0 2 > /dev/null 2>&1
  assertEquals 1 $?
}

test_change_xcode() {
  touch "$APPLICATIONS/Xcode-9.3.app"

  chxcode 9.3

  assertEquals "$APPLICATIONS/Xcode-9.3.app/Contents/Developer" "$DEVELOPER_DIR"
}

# shellcheck source=/dev/null
SHUNIT_PARENT=$0 . $SHUNIT2
